# 📱 iOS 捷徑設定完整指南

使用 iPhone 內建的「捷徑」App，一鍵觸發股票分析。

---

## 🎯 最終效果

- ✅ iPhone 主畫面上有「📊 股票分析」圖示
- ✅ 點擊後輸入股票代號（例如：AAPL）
- ✅ 自動執行分析，完成後收到郵件報告
- ✅ 整個過程 30 秒內完成

---

## 📋 前置需求

### 1. Mac 設定

**啟用遠端登入**:
1. 開啟「系統偏好設定」→「共享」
2. 勾選「遠端登入」
3. 建議只允許特定使用者（選擇你自己的帳號）
4. 記下你的**使用者名稱**和 **Mac IP 位址**

**查看 Mac IP 位址**:
```bash
# 方法 1: 系統偏好設定 → 網路
# 方法 2: 終端機執行
ifconfig | grep "inet " | grep -v 127.0.0.1
```

範例輸出: `192.168.1.100`

**測試 SSH 連線**（在 iPhone 上用 Terminus 等 App 測試）:
```bash
ssh your_username@192.168.1.100
# 輸入密碼後應該能登入
```

### 2. 確認腳本存在

執行腳本應該在:
```
~/finrobot-project/run_analysis.sh
```

測試執行:
```bash
~/finrobot-project/run_analysis.sh AAPL analyze
```

---

## 🛠️ iOS 捷徑設定步驟

### 方案 A: 簡單版（推薦初學者）

**功能**: 固定分析 AAPL 股票

#### 步驟 1: 建立新捷徑

1. 開啟 iPhone 的「捷徑」App
2. 點擊右上角「+」建立新捷徑
3. 點擊「加入動作」

#### 步驟 2: 加入 SSH 動作

1. 搜尋「透過 SSH 執行指令」
2. 如果找不到，搜尋「SSH」或「Run Script Over SSH」
3. 點擊加入

#### 步驟 3: 設定 SSH 連線

填寫以下資訊:

- **主機**: `192.168.1.100`（你的 Mac IP）
- **埠**: `22`（預設）
- **使用者**: `your_username`（你的 Mac 使用者名稱）
- **密碼**: 點擊「密碼」→ 輸入你的 Mac 登入密碼
- **指令**: `~/finrobot-project/run_analysis.sh AAPL analyze`

#### 步驟 4: 命名與儲存

1. 點擊上方「新捷徑」
2. 重新命名為「📊 AAPL 分析」
3. 點擊「完成」

#### 步驟 5: 測試執行

1. 點擊捷徑執行
2. 第一次會要求輸入密碼
3. 等待 10-30 秒
4. 完成後檢查郵箱是否收到報告

---

### 方案 B: 進階版（可輸入股票代號）

**功能**: 每次執行時輸入要分析的股票代號

#### 步驟 1-2: 同方案 A

#### 步驟 3: 加入詢問輸入

在「透過 SSH 執行指令」**之前**加入:

1. 搜尋「詢問輸入」（Ask for Input）
2. 加入這個動作
3. 設定:
   - **問題**: `請輸入股票代號`
   - **預設答案**: `AAPL`
   - **輸入類型**: 文字

#### 步驟 4: 設定變數

1. 點擊「詢問輸入」動作的輸出（藍色文字）
2. 選擇「設為變數」
3. 命名為「股票代號」

#### 步驟 5: 修改 SSH 指令

在 SSH 指令中使用變數:

```bash
~/finrobot-project/run_analysis.sh [變數:股票代號] analyze
```

點擊 `[變數:股票代號]` 的位置，選擇「變數」→「股票代號」

#### 完整捷徑流程:

```
1. [詢問輸入] 請輸入股票代號 (預設: AAPL)
   ↓
2. [設為變數] 股票代號
   ↓
3. [透過 SSH 執行指令]
   主機: 192.168.1.100
   使用者: your_username
   密碼: ********
   指令: ~/finrobot-project/run_analysis.sh [股票代號] analyze
```

#### 步驟 6: 命名與測試

命名為「📊 股票分析」，測試執行。

---

### 方案 C: 專業版（選擇分析或比較）

**功能**: 可選擇「單一分析」或「多股比較」

#### 額外步驟: 加入選單

在「詢問輸入」之後加入:

1. 搜尋「從選單中選擇」（Choose from Menu）
2. 加入兩個選項:
   - 選項 1: `單一股票分析`
   - 選項 2: `多股票比較`

#### 單一分析分支:

```bash
~/finrobot-project/run_analysis.sh [股票代號] analyze
```

#### 多股比較分支:

1. 再次「詢問輸入」: `請輸入股票代號（用逗號分隔，例如: AAPL,MSFT,GOOGL）`
2. 設為變數「股票列表」
3. SSH 指令:
```bash
~/finrobot-project/run_analysis.sh [股票列表] compare
```

---

## 🏠 加入主畫面

### 步驟 1: 開啟捷徑詳細資訊

1. 長按剛建立的捷徑
2. 選擇「詳細資訊」

### 步驟 2: 自訂外觀

1. 點擊「圖示」
2. 選擇顏色（建議：綠色或藍色）
3. 選擇圖示（建議：圖表、股票、折線圖）

### 步驟 3: 加入主畫面

1. 點擊「加入主畫面」
2. 自訂名稱（例如：「股票分析」）
3. 點擊「加入」

現在主畫面會出現圖示，點擊即可執行！

---

## 🔧 進階設定

### 1. 使用 SSH 金鑰（更安全）

不用每次都輸入密碼:

**Mac 上設定**:
```bash
# 生成 SSH 金鑰（如果沒有）
ssh-keygen -t ed25519

# 將公鑰加到授權清單
cat ~/.ssh/id_ed25519.pub >> ~/.ssh/authorized_keys
```

**iOS 捷徑中**:
- 不要填寫「密碼」欄位
- 在「SSH 金鑰」欄位選擇你的私鑰
- 可使用 Terminus 等 App 匯入金鑰

### 2. 遠端存取（不在同一 WiFi）

**選項 A: 使用 VPN**
- 設定 Tailscale 或 ZeroTier
- 取得 Mac 的 VPN IP
- 在捷徑中使用 VPN IP

**選項 B: 使用 ngrok**
```bash
# Mac 上執行
brew install ngrok
ngrok tcp 22
```

會得到類似 `0.tcp.ngrok.io:12345` 的網址，在捷徑中使用這個。

### 3. 通知提醒

在 SSH 指令後加入:

1. 搜尋「顯示通知」
2. 設定:
   - **標題**: `股票分析完成`
   - **本文**: `已發送報告到郵箱`

---

## 📊 使用範例

### 場景 1: 快速分析 Apple

1. 點擊主畫面「📊 股票分析」
2. 輸入 `AAPL`
3. 等待 20 秒
4. 收到郵件報告

### 場景 2: 比較科技股

1. 點擊捷徑
2. 選擇「多股票比較」
3. 輸入 `AAPL,MSFT,GOOGL,NVDA`
4. 等待 30 秒
5. 收到比較報告

### 場景 3: 使用 Siri

設定後可以對 Siri 說:
```
Hey Siri，股票分析
```

Siri 會執行捷徑並詢問股票代號。

---

## ❓ 常見問題

### Q1: SSH 連線失敗？

**A**: 檢查:
1. Mac 是否開啟「遠端登入」
2. iPhone 和 Mac 是否在同一 WiFi
3. IP 位址是否正確
4. 防火牆是否阻擋 SSH（埠 22）

測試: 用 Terminus App 嘗試連線 `ssh user@192.168.1.100`

### Q2: 執行時間太長？

**A**: 正常執行時間:
- 單一股票分析: 15-30 秒
- 多股票比較: 30-60 秒

如果超過 1 分鐘，檢查:
- Mac 網路速度
- Gemini API 額度是否用完
- 查看日誌: `cat ~/finrobot-logs.txt`

### Q3: Mac 休眠時能執行嗎？

**A**: 可以，但需要設定:
1. 系統偏好設定 → 節能
2. 勾選「喚醒以供 WiFi 網路存取」
3. 或使用「排程」讓 Mac 定時喚醒

### Q4: 想在外面（不在家）執行？

**A**: 參考「進階設定 → 遠端存取」章節，使用 VPN 或 ngrok。

### Q5: 可以自動化嗎（不用手動點擊）？

**A**: 可以！在「捷徑」中建立「自動化」:
1. 自動化 → 加入「時間」觸發
2. 設定每天 09:00 執行
3. 選擇你的股票分析捷徑
4. 關閉「執行前先詢問」

---

## 🎨 捷徑美化

### 推薦圖示

- 📊 圖表
- 📈 上升趨勢
- 💹 日圓符號
- 💰 錢袋
- 🤖 機器人

### 推薦顏色

- **綠色**: 象徵成長、獲利
- **藍色**: 專業、穩定
- **紅色**: 警示、重要
- **金色**: 財富、高級

---

## 📝 下一步

完成設定後，你可以:

1. ✅ 建立多個捷徑（不同股票組合）
2. ✅ 設定自動化（定時執行）
3. ✅ 分享捷徑給家人朋友
4. ✅ 整合到 Widget（桌面小工具）

需要其他手機觸發方案（Telegram Bot、API）的完整實作嗎？
